# Social Media Parser

Этот проект представляет собой парсер данных социальных сетей с использованием Python и Selenium. Он позволяет собирать статистику (просмотры, лайки, комментарии и т.д.) с платформ, таких как Telegram, YouTube, VK, Instagram и Одноклассники, через сервис Popsters.

## Возможности

- Парсинг статистики с заданных ссылок на социальные сети.
- Диапазон дат для анализа берётся из файла `dates.txt`.
- Сохранение результатов в Excel-файл с динамическими столбцами.
- Интерактивный процесс авторизации перед началом парсинга.
- Фильтрация ссылок по поддерживаемым платформам (VK, Facebook, Instagram, Telegram, YouTube, Одноклассники).
- Автоматическое обновление ChromeDriver для совместимости с установленной версией Chrome.

## Требования

- Python 3.13.2 или выше
- Google Chrome (для Selenium WebDriver)
- Активный аккаунт на [Popsters](https://popsters.ru)

## Установка

1. **Клонируйте репозиторий**:

   ```bash
   git clone https://github.com/your-username/social-media-parser.git
   cd social-media-parser
   ```

2. **Создайте виртуальное окружение**:

   ```bash
   python -m venv .venv
   ```

3. **Активируйте виртуальное окружение**:

   - На Windows:

     ```bash
     .venv\Scripts\activate
     ```

   - На macOS/Linux:

     ```bash
     source .venv/bin/activate
     ```

4. **Установите зависимости**:

   ```bash
   pip install -r requirements.txt
   ```

## Использование

1. **Подготовьте файл со ссылками**:

   Создайте папку `source` в корневой директории проекта. Поместите туда Excel-файл (например, `исходный_файл.xlsx`) со списком ссылок. Файл должен содержать столбцы `Ссылка`, `Подписчики`, `Лайки`, `Репосты`, `Комментарии`, `Просмотры`, `Публикации`. Пример структуры:

   ```
   Ссылка                          Подписчики  Лайки  Репосты  Комментарии  Просмотры  Публикации
   https://vk.com/public45608667   0           0      0        0            0          0
   https://t.me/+a0fqF50bfYs2MGYy  0           0      0        0            0          0
   ```

2. **Подготовьте файл с диапазоном дат**:

   Создайте файл `dates.txt` в корневой директории проекта и укажите диапазон дат в формате `ДД.ММ.ГГГГ-ДД.ММ.ГГГГ`. Пример:

   ```
   01.01.2024-31.01.2024
   ```

3. **Запустите скрипт**:

   ```bash
   python run_parser.py
   ```

   Диапазон дат автоматически берётся из файла `dates.txt`.

4. **Авторизуйтесь**:

   - После запуска скрипта откроется браузер Chrome.
   - Войдите в свой аккаунт на Popsters.
   - Для YouTube может потребоваться дополнительная авторизация через Google — следуйте инструкциям в браузере.
   - После авторизации вернитесь в терминал и нажмите Enter, чтобы начать парсинг.

5. **Проверьте результаты**:

   - Результаты будут сохранены в файл `results/results.xlsx`.
   - Структура файла будет идентична исходному файлу, но данные для поддерживаемых платформ будут обновлены.

## Структура проекта

```
social-media-parser/
├── run_parser.py      # Основной скрипт парсинга
├── dates.txt          # Файл с диапазоном дат
├── source/            # Папка для исходного Excel-файла (добавьте свой .xlsx файл)
├── profile/           # Папка для профиля браузера (игнорируется)
├── driver/            # Папка для ChromeDriver (игнорируется)
├── results/           # Папка для результатов (игнорируется)
├── .gitignore         # Файл для игнорирования ненужных файлов
├── requirements.txt   # Зависимости проекта
└── README.md          # Описание проекта
```

## Возможные проблемы

- **Авторизация на YouTube**: Google может блокировать автоматический вход через Selenium. Попробуйте авторизоваться вручную в открытом браузере.
- **Ошибки парсинга**: Если элементы на сайте Popsters изменились, скрипт может не найти нужные поля. Обновите селекторы в методе `parser()` в `run_parser.py`.
- **Совместимость Chrome**: Скрипт автоматически скачивает подходящую версию ChromeDriver. Если возникают проблемы, убедитесь, что Chrome установлен и обновлён.
- **Отсутствие файла `dates.txt`**: Убедитесь, что файл `dates.txt` создан и содержит диапазон дат в правильном формате.
- **Отсутствие файла в папке `source`**: Убедитесь, что в папке `source` есть хотя бы один `.xlsx` файл с корректной структурой.

## Лицензия

Этот проект распространяется под лицензией MIT. См. файл `LICENSE` для подробностей (если вы добавите его).

## Контакты

Если у вас есть вопросы или предложения, создайте issue в репозитории или свяжитесь со мной через [email@example.com](mailto:email@example.com).